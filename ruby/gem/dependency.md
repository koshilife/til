# ライブラリの依存関係の管理の仕方

管理しているGemの依存ライブラリがyankされていたので、test が通らなくなり、更新を迫られた際に調べたことをメモ
https://github.com/koshilife/omniauth-zoom/issues/11
 

## 指定の仕方

- 固定
  - 例 `1.0.0` バージョンを固定します。
- `>=`, `<` 下限、上限指定
  - 例 `>= 1.0.0` 1.0.0以上のバージョンが必要になります。
  - 例 `>= 1.0.0, < 2.0.0` 1.0.0以上、2.0.0未満のバージョンが必要になります。
- `~>` 下限、メジャー、マイナーの上限指定 (※詳細は検証したほうがよい, 参考サイトで解釈が揺れていたので)
  - 例 `~> 1.0.0` 1.0.0以上で利用可能で、1.0.9などは問題なく、1.1にバージョンが上がると利用不可になります。
  - 例 `~> 1.0` 1.0以上で利用可能で、1.9などは問題なく、2.0にバージョンが上がると利用不可になります。  
- 指定なし
  - バージョン指定無しの場合は、常に最新版をインストールします。

## ベストプラクティスは？

- runtime dependency
  - バージョン指定することで、意図しないバグ混入が防げる
  - 上限を指定することで、大きな変更などは入れないようにでき、細かいバグ修正などは自動的に取り込める
  - ライブラリの管理コストとサービス信頼性とのトレードオフの関係となる
    - 安定が求められるならバージョン固定
    - 多少のダウンタイムが、許されるなら`~>`
    - 可用性低くてもよければ、ライブラリ管理から解放される下限のみでもよいかと
- development dependency
  - テスト環境なのでCIが動いているのであれば、最新版取り込む形にするのがよいかと、下限かバージョンなし


参考
- [Gemfileでバージョン指定できる種類](https://blog.yuhiisk.com/archive/2017/04/24/specify-the-version-of-gemfile.html)
- [gemのバージョン指定法(>=,~>,など)について](https://haayaaa.hatenablog.com/entry/2018/10/29/235952)
